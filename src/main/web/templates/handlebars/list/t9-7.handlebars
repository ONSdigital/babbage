{{!-- Resolve parents of current uri for and assign to variable breadcrumb for building breadcrumb --}}
{{resolveParents uri assign="breadcrumb"}}
{{!-- Resolve navigation fetching children of root uri "/" with depth 2 --}}
{{resolveChildren "/" depth=2 assign="navigation"}}

{{> partials/header}}

<main id="main" role="main" tabindex="-1">
	<div class="wrapper panel--top-mar">
		{{> partials/breadcrumb}}
		<h1 class="page-header__title flush--half--bottom">Methodology</h1>
		<p>
			{{#if statisticsSearchResult.results}}
			<span class="stand-out-text">{{statisticsSearchResult.numberOfResults}}</span> results for <strong>methodology</strong> showing {{#contains types 'qmi'}}<strong>Quality and Methodology Information (QMI)</strong>{{/contains}} {{#contains types 'article'}}<strong>articles</strong>{{/contains}} related to <strong>{{#each breadcrumb}}{{#if @last}}{{description.title}}{{/if}}{{/each}}</strong>.
			{{else}}
			Sorry, there is no <strong>methodology</strong> for <strong>{{#each breadcrumb}}{{#if @last}}{{description.title}}{{/if}}{{/each}}</strong>.
			{{/if}}
		</p>
	</div>
	<!-- /wrapper -->
	<div class="wrapper panel--mar print-links">
		{{#if statisticsSearchResult.results}}
		<div class="grid-wrap">
			<div class="grid-col desktop-grid-one-third">
				<article class="box box--padded sectioned print-hidden">
					<form id="filters">
						<div class="panel panel--bottom-pad panel--separated--bottom flush">
							<h3 class="flush float-left">Refine results</h3>
							<button type="reset" value="Reset" class="btn btn--primary btn--small btn--thin btn--narrow btn--clear-results float-right">Clear</button>
						</div>
						<div class="box__content">
							<label for="keywords">
								<p class="panel panel--separated--bottom">Contains</p>
								<input class="input input--med" type="text" placeholder="Keywords">
							</label>
							<p class="panel panel--separated--bottom">Content types to show</p>
							<ul class="list--neutral">
								<li>
									<input type="checkbox" name="type" value="qmi" {{#contains types 'qmi'}}checked{{/contains}} />
									<label for="checkbox-statsbulletin">
										Quality and Methodology Information (QMI)
									</label>
								</li>
								<li>
									<input type="checkbox" name="type" value="article" {{#contains types 'article'}}checked{{/contains}} />
									<label for="checkbox-statsbulletin">
										Article
									</label>
								</li>
							</ul>
							<div class="panel panel--separated--bottom">
								<label for="select">Topics</label>
							</div>
							<div class="field field--spaced">
								<select class="input input--mini" name="topics">
								<option value="1" selected>All</option>
								{{#each navigation.nodes}}
								<option value="{{slugify title}}">{{title}}</option>
								{{/each}}
							</select>
							</div>
							<!-- /field drop-down -->
						</div>
						<div>
							<button type="submit" class="btn btn--primary btn--small panel--mar-small">Filter</button>
						</div>
					</form>
					<!-- /box__content -->
				</article>
				<!-- /box 'refine results' -->
				<article class="box box--purple box--purple--separated--left">
					<div class="box__inner border box--padded">
						<header class="box__header">
							<h3 class="gamma">Need an earlier release?</h3>
						</header>
						<div class="box__content">
							<p>
								We moved them to <a href="#">The National Archives</a> website, to keep this website as responsive as possible.
							</p>
							<p>
								<strong>Please note: </strong>all historical data is still on this website.
							</p>
						</div>
					</div>
					<!-- /box__inner -->
				</article>
				<!-- /box -->
			</div>
			<!-- /desktop-grid-one-third -->
			<div class="grid-col desktop-grid-two-thirds">
				<ul class="list--neutral">
					{{#each statisticsSearchResult.results}}
					<li>
						<h3 class="flush inline"><a href="{{uri}}">{{description.title}}
						{{#if description.edition}}
							{{#if_ne description.edition 'yes'}}: {{description.edition}}{{/if_ne}}
						{{/if}}</a></h3>
						<span class="lozenge">{{#if_eq type 'qmi'}}QMI{{/if_eq}}{{#if_ne type 'qmi'}}{{type}}{{/if_ne}}</span>
						<p class="mini flush description">
							Released: {{df description.releaseDate}}
						</p>
						{{md description.metaDescription}}
					</li>
					{{/each}}
				</ul>
				{{!-- Paginator --}}
				{{#if_ne numberOfPages 1}}
				<nav>
					<ul class="nav nav--inline-block">
						{{#if_ne currentPage startPage}}
						<li>
							<a href="methodology?page={{decrement currentPage}}" class="page-link previous">Prev</a>
						</li>
						{{/if_ne}}
						{{#each pages}}
						<li>
							{{#if_eq this currentPage}}<span>{{this}}</span>{{/if_eq}}
							{{#if_ne this currentPage}}<a href="methodology?page={{this}}" class="page-link" >{{this}}</a>{{/if_ne}}
						</li>
						{{/each}}
						{{#if_ne currentPage endPage}}
						<li>
							<a href="methodology?page={{increment currentPage}}" class="page-link next" >Next</a>
						</li>
						{{/if_ne}}
					</ul>
				</nav>
				{{/if_ne}}
				<!-- /panel--seperated--top 'pagination' -->
			</div>
			<!-- /desktop-grid-two-thirds -->
			{{/if}}
		</div>
		<!-- /grid-wrap -->
	</div>
	<!-- /wrapper -->
</main>
{{> partials/footer}}
